<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.htjy.dao.TaskDao">
	<insert id="addTask" parameterType="com.htjy.entity.TaskModel" useGeneratedKeys="true">
		<selectKey resultType="int" order="AFTER" keyProperty="id"> 
	    SELECT LAST_INSERT_ID() AS id 
	    </selectKey>
		INSERT INTO tb_task_info 
		(title,type,location,address,lockTime,remark,schedule,score,setPerson,setTime) 
		VALUES 
		(#{title},#{type},#{location},#{address},#{lockTime},
		#{remark},#{schedule},#{score},#{setPerson},now())
	</insert>
	
	<insert id="addTaskSchedule">
		insert into tb_task_schedule_info (tid,daytime)
		values
		<foreach collection="list" item="emp" separator=",">  
            (#{emp.tid},#{emp.daytime})  
        </foreach> 
	</insert>
	
	<select id="getTaskList" parameterType="String" resultType="com.htjy.entity.TaskModel">
		select * from tb_task_info where 1=1
		<if test='title!=null and title!="" '>
			and title like concat(concat('%',#{title}),'%')
		</if>
	</select>
</mapper>
 